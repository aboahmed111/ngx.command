{"version":3,"sources":["command.directive.ts"],"names":[],"mappings":";;;;;;;;;;;;;;IAsBA;QAIC;YACC,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE;gBACnB,iBAAiB,EAAE,WAAW;aACZ,CAAC,CAAC;QACtB,CAAC;QACF,oBAAC;IAAD,CATA,AASC,IAAA;IATY,qBAAa,gBASzB,CAAA;IACY,8BAAsB,GAAG,IAAI,aAAa,EAAE,CAAC;IAG1D;;;;;;;;;;OAUG;IAIH;QASC,0BACa,MAAqB,EACzB,QAAkB,EAClB,OAAmB;YADnB,aAAQ,GAAR,QAAQ,CAAU;YAClB,YAAO,GAAP,OAAO,CAAY;YATnB,mBAAc,GAAmB,8BAAsB,CAAC,CAAC,wCAAwC;YAWzG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,cAAc,EAAE,MAAM,CAAC,CAAC;QAC5C,CAAC;QAED,mCAAQ,GAAR;YAAA,iBAiBC;YAhBA,OAAO,CAAC,GAAG,CAAC,0BAA0B,CAAC,CAAC;YAExC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;gBACnB,MAAM,IAAI,KAAK,CAAC,+CAA+C,CAAC,CAAC;YAClE,CAAC;YAED,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW;iBAC1C,EAAE,CAAC,UAAA,CAAC;gBACJ,OAAO,CAAC,GAAG,CAAC,iCAAiC,EAAE,CAAC,CAAC,CAAC;gBAClD,KAAI,CAAC,UAAU,GAAG,CAAC,CAAC,CAAC;YACtB,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC;YAChB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY;iBAC5C,EAAE,CAAC,UAAA,CAAC;gBACJ,OAAO,CAAC,GAAG,CAAC,kCAAkC,EAAE,CAAC,CAAC,CAAC;gBACnD,KAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,KAAI,CAAC,OAAO,CAAC,aAAa,EAAE,KAAI,CAAC,cAAc,CAAC,iBAAiB,EAAE,CAAC,CAAC,CAAC;YACrG,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC;QACjB,CAAC;QAGD,kCAAO,GAAP;YACC,OAAO,CAAC,GAAG,CAAC,6BAA6B,CAAC,CAAC;YAC3C,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;QACxB,CAAC;QAED,sCAAW,GAAX;YACC,OAAO,CAAC,GAAG,CAAC,6BAA6B,CAAC,CAAC;YAC3C,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;YACvB,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;YAChC,IAAI,CAAC,aAAa,CAAC,WAAW,EAAE,CAAC;QAClC,CAAC;QA7CD;YAAC,YAAK,EAAE;;yDAAA;QACR;YAAC,YAAK,EAAE;;gEAAA;QACR;YADkE,wCAAwC;YACzG,kBAAW,CAAC,UAAU,CAAC;;4DAAA;QAgCxB;YAAC,mBAAY,CAAC,OAAO,CAAC;;;;uDAAA;QAvCvB;YAAC,gBAAS,CAAC;gBACV,QAAQ,EAAE,WAAW;aACrB,CAAC;uBAWC,eAAQ,EAAE;;4BAXX;QAiDF,uBAAC;IAAD,CAhDA,AAgDC,IAAA;IAhDY,wBAAgB,mBAgD5B,CAAA","file":"command.directive.js","sourcesContent":["import {\r\n\tDirective,\r\n\tOnInit,\r\n\tOnDestroy,\r\n\tInput,\r\n\tHostBinding,\r\n\tHostListener,\r\n\tRenderer,\r\n\tElementRef,\r\n\t// OpaqueToken,\r\n\t// Inject,\r\n\tOptional\r\n} from \"@angular/core\";\r\nimport {Subscription} from \"rxjs/Subscription\";\r\n\r\nimport {ICommand} from \"./command\";\r\n\r\n// const COMMAND_CONFIG = new OpaqueToken(\"command.config\");\r\nexport interface CommandOptions {\r\n\texecutingCssClass: string;\r\n}\r\n\r\nexport class CommandConfig implements CommandOptions {\r\n\r\n\texecutingCssClass: string;\r\n\r\n\tconstructor() {\r\n\t\tObject.assign(this, {\r\n\t\t\texecutingCssClass: \"executing\"\r\n\t\t} as CommandOptions);\r\n\t}\r\n}\r\nexport const COMMAND_DEFAULT_CONFIG = new CommandConfig();\r\n\r\n\r\n/**\r\n *\r\n * ### Example with options\r\n * ```html\r\n * <button [command]=\"saveCmd\" [commandOptions]=\"{executingCssClass: 'in-progress'}\">Save</button>\r\n * ```\r\n * @export\r\n * @class CommandDirective\r\n * @implements {OnInit}\r\n * @implements {OnDestroy}\r\n */\r\n@Directive({\r\n\tselector: \"[command]\",\r\n})\r\nexport class CommandDirective implements OnInit, OnDestroy {\r\n\r\n\t@Input() command: ICommand;\r\n\t@Input() commandOptions: CommandOptions = COMMAND_DEFAULT_CONFIG; // = { executingCssClass: \"executing\" };\r\n\t@HostBinding(\"disabled\") isDisabled: boolean;\r\n\r\n\tprivate canExecute$$: Subscription;\r\n\tprivate isExecuting$$: Subscription;\r\n\r\n\tconstructor(\r\n\t\t@Optional() config: CommandConfig,\r\n\t\tprivate renderer: Renderer,\r\n\t\tprivate element: ElementRef\r\n\t) {\r\n\t\tObject.assign(this.commandOptions, config);\r\n\t}\r\n\r\n\tngOnInit() {\r\n\t\tconsole.log(\"[commandDirective::init]\");\r\n\r\n\t\tif (!this.command) {\r\n\t\t\tthrow new Error(\"[commandDirective] command should be defined!\");\r\n\t\t}\r\n\r\n\t\tthis.canExecute$$ = this.command.canExecute$\r\n\t\t\t.do(x => {\r\n\t\t\t\tconsole.log(\"[commandDirective::canExecute$]\", x);\r\n\t\t\t\tthis.isDisabled = !x;\r\n\t\t\t}).subscribe();\r\n\t\tthis.isExecuting$$ = this.command.isExecuting$\r\n\t\t\t.do(x => {\r\n\t\t\t\tconsole.log(\"[commandDirective::isExecuting$]\", x);\r\n\t\t\t\tthis.renderer.setElementClass(this.element.nativeElement, this.commandOptions.executingCssClass, x);\r\n\t\t\t}).subscribe();\r\n\t}\r\n\r\n\t@HostListener(\"click\")\r\n\tonClick() {\r\n\t\tconsole.log(\"[commandDirective::onClick]\");\r\n\t\tthis.command.execute();\r\n\t}\r\n\r\n\tngOnDestroy() {\r\n\t\tconsole.log(\"[commandDirective::destroy]\");\r\n\t\tthis.command.destroy();\r\n\t\tthis.canExecute$$.unsubscribe();\r\n\t\tthis.isExecuting$$.unsubscribe();\r\n\t}\r\n}"]}